(this["webpackJsonp8086.js"]=this["webpackJsonp8086.js"]||[]).push([[0],{55:function(e,t,n){e.exports=n(76)},64:function(e,t,n){},65:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),a=n(24),s=n.n(a),o=n(6),u=(n(64),n(65),n(52)),l=n(96),c=n(95),h=n(92),m=n(48),p=n.n(m),v=(n(71),n(72),n(32)),f=n(53),b=n(2),d=n(5),g=[" ","\t"],E=[].concat(["AX","BX","CX","DX","AL","BL","CL","DL","AH","BH","CH","DH"],["DI","SI","BP","SP"],["DS","ES","SS","CS"]),N=["AAA","AAD","AAM","AAS","ADC","ADD","AND","CALL","CBW","CLC","CLD","CLI","CMC","CMP","CMPSB","CMPSW","CWD","DAA","DAS","DEC","DIV","HLT","IDIV","IMUL","IN","INC","INT","INTO","IRET","JA","JAE","JB","JBE","JC","JCXZ","JE","JG","JGE","JL","JLE","JMP","JNA","JNAE","JNB","JNBE","JNC","JNE","JNG","JNGE","JNL","JNLE","JNO","JNP","JNS","JNZ","JO","JP","JPE","JPO","JS","JZ","LAHF","LDS","LEA","LES","LODSB","LODSW","LOOP","LOOPE","LOOPNE","LOOPNZ","LOOPZ","MOV","MOVSB","MOVSW","MUL","NEG","NOP","NOT","OR","OUT","POP","POPA","POPF","PUSH","PUSHA","PUSHF","RCL","RCR","REP","REPE","REPNE","REPNZ","REPZ","RET","RETF","ROL","ROR","SAHF","SAL","SAR","SBB","SCASB","SCASW","SHL","SHR","STC","STD","STI","STOSB","STOSW","SUB","TEST","XCHG","XLATB","XOR"],O=function(e){return 1<<e},w={sign:O(7),zero:O(6),auxilliary:O(4),carry:O(0),overflow:O(11),directional:O(10),interrupt:O(9),trap:O(8)},y=function e(t){var n=t.value,i=t.position,r=t.lineNumber;Object(b.a)(this,e),this.name="NEWLINE",this.value=n,this.position=i,this.lineNumber=r},A=function e(t){var n=t.value,i=t.position,r=t.lineNumber;Object(b.a)(this,e),this.name="COMMENT",this.value=n,this.position=i,this.lineNumber=r},S=function e(t){var n=t.value,i=t.position,r=t.lineNumber;Object(b.a)(this,e),this.name="MNEMONIC",this.value=n,this.position=i,this.lineNumber=r},j=function e(t){var n=t.value,i=t.position,r=t.lineNumber;Object(b.a)(this,e),this.name="SEPARATOR",this.value=n,this.position=i,this.lineNumber=r},k=function e(t){var n=t.value,i=t.position,r=t.lineNumber;Object(b.a)(this,e),this.name="STRING",this.value=n,this.position=i,this.lineNumber=r},C=function e(t){var n=t.mnemonic,i=t.op1,r=t.op2;Object(b.a)(this,e),this.mnemonic=n,this.op1=i,this.op2=r},I=n(7),L=n(8),D=n(23),R=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.position,a=e.lineNumber;return Object(b.a)(this,n),(i=t.call(this)).name="Invalid Token",i.position=r,i.lineNumber=a,i}return n}(Object(D.a)(Error)),M=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.position,a=e.lineNumber;return Object(b.a)(this,n),(i=t.call(this)).name="Unterminated Quote",i.position=r,i.lineNumber=a,i}return n}(Object(D.a)(Error)),X=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.position,a=e.lineNumber;return Object(b.a)(this,n),(i=t.call(this)).name="Unterminated Bracket",i.position=r,i.lineNumber=a,i}return n}(Object(D.a)(Error)),x=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.position,a=e.lineNumber;return Object(b.a)(this,n),(i=t.call(this)).name="Syntax Error",i.position=r,i.lineNumber=a,i}return n}(Object(D.a)(Error));function B(e){var t;t=e.startsWith("0B")?parseInt(e,2):e.startsWith("0X")?parseInt(e,16):e.startsWith("0")?parseInt(e,8):parseInt(e,10);var n=Math.ceil(Math.log2(t));if(t>Math.pow(2,16))throw Error("Immediate Value too large, only max 16 bit allowd");return{value:t,size:n}}var P=function e(t,n,i){Object(b.a)(this,e),this.name="OPERAND",this.value=t,this.size=0,this.position=n,this.lineNumber=i},T=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.value,a=e.position,s=e.lineNumber;Object(b.a)(this,n),(i=t.call(this,r,a,s)).type="IMMEDIATE";var o=B(r);if(i.value=o.value,i.size=o.size,Number.isNaN(i.value))throw new R({position:i.position,lineNumber:i.lineNumber});return i}return n}(P),J=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.value,a=e.position,s=e.lineNumber;return Object(b.a)(this,n),(i=t.call(this,r,a,s)).type="RELATIVE",i.size=16,i}return n}(P),z=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.value,a=e.position,s=e.lineNumber;return Object(b.a)(this,n),(i=t.call(this,r,a,s)).type="REGISTER",i.value.endsWith("L")||i.value.endsWith("H")?i.size=8:i.size=16,i}return n}(P),H=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(e){var i,r=e.value,a=e.position,s=e.lineNumber;return Object(b.a)(this,n),(i=t.call(this,r,a,s)).type="MEMORY",i.size=16,i.value=B(r.slice(1,-1)).value,i}return n}(P),W=function(){function e(t){Object(b.a)(this,e),this.position=0,this.buffer=t,this.bufferLength=t.length,this.lineNumber=1}return Object(d.a)(e,[{key:"skipNonTokens",value:function(){for(;this.position<this.bufferLength;){var e=this.buffer[this.position];if(!g.includes(e))break;this.position+=1}}},{key:"processNewLine",value:function(e){this.lineNumber+=1;var t=new y({value:e,position:this.position,lineNumber:this.lineNumber});return this.position+=1,t}},{key:"processComment",value:function(){for(var t=this.position+1;t<this.bufferLength&&!e.isNewLine(this.buffer[t]);)t+=1;var n=new A({value:this.buffer.substring(this.position,t),position:this.position,lineNumber:this.lineNumber});return this.position=t,n}},{key:"processAlphaNum",value:function(){for(var t=this.position+1;t<this.bufferLength&&e.isAlphaNum(this.buffer[t]);)t+=1;var n=this.buffer.substring(this.position,t).toUpperCase();if(N.includes(n)){var i=new S({value:n,position:this.position,lineNumber:this.lineNumber});return this.position=t,i}if(E.includes(n)){var r=new z({value:n,position:this.position,lineNumber:this.lineNumber});return this.position=t,r}if(new RegExp("^".concat("(0X|0B|0|)[0-9A-F]+","$")).test(n)){var a=new T({value:n,position:this.position,lineNumber:this.lineNumber});return this.position=t,a}throw new R({position:this.position,lineNumber:this.lineNumber})}},{key:"processBrackets",value:function(){var e=this.buffer.indexOf("]",this.position+1);if(-1===e)throw new X({position:this.position,lineNumber:this.lineNumber});var t=this.buffer.substring(this.position,e+1).toUpperCase();if(new RegExp("\\[".concat("(0X|0B|0|)[0-9A-F]+","\\]")).test(t)){var n=new H({value:t,position:this.position,lineNumber:this.lineNumber});return this.position=e+1,n}if(/^\[[A-Z]{2}\+[A-Z]{2}\]$/.test(t)){var i=new J({value:t,position:this.position,lineNumber:this.lineNumber});return this.position=e+1,i}throw new R({position:this.position,lineNumber:this.lineNumber})}},{key:"processQuote",value:function(e){var t=this.buffer.indexOf(e,this.position+1);if(-1===t)throw new M({position:this.position,lineNumber:this.lineNumber});var n=new k({value:this.buffer.substring(this.position,t+1),position:this.position,lineNumber:this.lineNumber});return this.position=t+1,n}},{key:"processSeparator",value:function(e){var t=this.position+1,n=new j({value:e,position:this.position,lineNumber:this.lineNumber});return this.position=t,n}},{key:"nextToken",value:function(){if(this.skipNonTokens(),!(this.position>=this.bufferLength)){var t=this.buffer[this.position];if(e.isNewLine(t))return this.processNewLine(t);if(e.isComment(t))return this.processComment();if(e.isAlphaNum(t))return this.processAlphaNum();if(e.isBracket(t))return this.processBrackets();if(e.isQuote(t))return this.processQuote(t);if(e.isSeparator(t))return this.processSeparator(t);throw new R({position:this.position,lineNumber:this.lineNumber})}}},{key:"tokenize",value:function(){for(var e=[];this.position<this.bufferLength;){var t=this.nextToken();t&&e.push(t)}return e.push(new y({value:"\n",position:this.positon+1,lineNumber:this.lineNumber+1})),e}}],[{key:"isNewLine",value:function(e){return/^[\n\r]$/.test(e)}},{key:"isComment",value:function(e){return/^[;]$/.test(e)}},{key:"isAlpha",value:function(e){return/^[A-Za-z]$/.test(e)}},{key:"isNum",value:function(e){return/^[0-9]$/.test(e)}},{key:"isAlphaNum",value:function(e){return/^[A-Za-z0-9]$/.test(e)}},{key:"isBracket",value:function(e){return/^[[]$/.test(e)}},{key:"isQuote",value:function(e){return/^['"]$/.test(e)}},{key:"isSeparator",value:function(e){return/^[,]$/.test(e)}}]),e}(),F=function(){function e(t){Object(b.a)(this,e),this.value=t||0,this.h=0,this.l=0}return Object(d.a)(e,[{key:"get",value:function(e){return e?"L"===e?this.l:"H"===e?this.h:void 0:this.value}},{key:"set",value:function(e,t){if(t){if(e>Math.pow(2,8))throw Error("Can't set more than 8 bit value to an 8 bit register")}else if(e>Math.pow(2,16))throw Error("Can't set more than 8 bit value to an 16 bit register");if(!t)return this.value=e,this.l=255&e,void(this.h=e>>>8);"L"===t?this.l=e:"H"===t&&(this.h=e),this.value=(this.h<<4)+this.l}}]),e}(),V=function(e){Object(I.a)(n,e);var t=Object(L.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"setFlag",value:function(e){this.set(this.get()|e)}},{key:"unsetFlag",value:function(e){this.set(this.get()&~e)}},{key:"getFlag",value:function(e){return 0===(this.get()&e)?0:1}}]),n}(F),U=function e(){Object(b.a)(this,e),this.regs={AX:new F,BX:new F,CX:new F,DX:new F,IP:new F,DI:new F,SI:new F,BP:new F(400),SP:new F(400),DS:new F(0),ES:new F(400),CS:new F(600),SS:new F(200),flags:new V}},$=function(){function e(){Object(b.a)(this,e),this.mem=[],this.initializeMem()}return Object(d.a)(e,[{key:"initializeMem",value:function(){for(var e=0;e<1e3;e+=1)this.mem.push(0)}},{key:"set",value:function(e,t){if(t>Math.pow(2,16))throw Error("Can't set greater than 16 bit value in memory location");this.mem[e]=t}},{key:"get",value:function(e){return this.mem[e]}}]),e}(),G=function(){function e(t,n){Object(b.a)(this,e),this.registers=t,this.memory=n}return Object(d.a)(e,[{key:"get",value:function(e){if(!e)return null;var t=this.registers.regs;switch(e.type){case"IMMEDIATE":return e.value;case"REGISTER":if(["L","H"].includes(e.value[1])){if(!["A","B","C","D"].includes(e.value[0]))throw SyntaxError("Only AX,BX,CX,DX registers can have 'L' or 'H' suffix");return t["".concat(e.value[0],"X")].get(e.value[1])}return t[e.value].get();case"MEMORY":return this.memory.get(t.DS.get()+e.value);case"RELATIVE":throw SyntaxError("Not implemented");default:throw SyntaxError("Invalid Adressing mode, this shoudln't happen ideally")}}},{key:"set",value:function(e,t){var n=this.registers.regs;switch(e.type){case"IMMEDIATE":throw SyntaxError("Can't set to immediate value???");case"REGISTER":if(["L","H"].includes(e.value[1])){if(!["A","B","C","D"].includes(e.value[0]))throw SyntaxError("Only AX,BX,CX,DX registers can have 'L' or 'H' suffix");return n["".concat(e.value[0],"X")].set(t,e.value[1])}return n[e.value].set(t);case"MEMORY":return this.memory.set(n.DS.get()+e.value,t);case"RELATIVE":throw SyntaxError("Not implemented");default:throw SyntaxError("Invalid Adressing mode, this shoudln't happen ideally")}}}]),e}(),Z=function(){function e(){Object(b.a)(this,e),this.registers=new U,this.memory=new $,this.addressing=new G(this.registers,this.memory)}return Object(d.a)(e,[{key:"loadCode",value:function(e){var t=this,n=this.registers.regs.CS.get();e.forEach((function(e,i){t.memory.set(n+i,e)}))}},{key:"step",value:function(){var e=this,t=this.registers.regs.IP.get(),n=this.memory.get(this.registers.regs.CS.get()+t),i=n.mnemonic,r=n.op1,a=n.op2,s=this.registers.regs,o=function(t){return e.addressing.get(t)},u=function(t,n){return e.addressing.set(t,n)};if(!i)throw SyntaxError("Invalid instruction at the current instruction pointer");switch(i.value){case"MOV":if(r.size<a.size)throw SyntaxError("Can't move larger ".concat(a.size," bit value to ").concat(r.size," bit location"));u(r,o(a));break;case"JS":1===s.flags.getFlag(w.sign)&&s.IP.set(r);break;case"ADD":if(a){var l=o(r);u(r,l+=o(a))}else{var c=8===r.size?s.AX.get("l"):s.AX.get();c+=o(r),s.AX.set(c)}break;case"DIV":if(8===r.size){var h=s.AX.get("l")/o(r),m=s.AX.get("l")%o(r);s.AX.set(h,"l"),s.AX.set(m,"h")}else{var p=s.AX.get()/o(r),v=s.AX.get()%o(r);s.AX.set(p),s.DX.set(v)}break;case"MUL":if(8===r.size){var f=s.AX.get("l")*o(r);s.AX.set(f)}else{var b=s.AX.get()*o(r);s.AX.set(b)}break;case"AND":u(r,o(r)&o(a));break;case"OR":u(r,o(r)|o(a))}s.IP.set(t+1)}}]),e}(),Q=function(){function e(t){Object(b.a)(this,e),this.rawInstructions=e.getInstructionsFromTokens(t),this.instructions=[]}return Object(d.a)(e,[{key:"parse",value:function(){var e=this;return this.rawInstructions.forEach((function(t){if(t.length>4)throw new x;if(t.length>2&&"SEPARATOR"!==t[2].name)throw new x;e.instructions.push(new C({mnemonic:t[0],op1:t[1]||null,op2:t[3]||null}))})),this.instructions}}],[{key:"getInstructionsFromTokens",value:function(e){var t=[],n=[];return e.forEach((function(e){"NEWLINE"===e.name?(n.length&&t.push(n),n=[]):"COMMENT"!==e.name&&n.push(e)})),t}}]),e}(),Y=new(function(){function e(){Object(b.a)(this,e),this.cpu=new Z}return Object(d.a)(e,[{key:"loadCode",value:function(e){var t=new W(e).tokenize(),n=new Q(t).parse();this.cpu.loadCode(n)}},{key:"getRegisters",value:function(){var e={};return Object.entries(this.cpu.registers.regs).forEach((function(t){["A","B","C","D"].includes(t[0][0])&&(e["".concat(t[0][0],"H")]=t[1].get("H"),e["".concat(t[0][0],"L")]=t[1].get("L")),e[t[0]]=t[1].get()})),e}},{key:"getMemory",value:function(){return Object(f.a)(this.cpu.memory.mem)}},{key:"resetState",value:function(){this.cpu=new Z}}]),e}()),_={registers:Y.getRegisters(),memory:Y.getMemory(),code:""},q=Object(v.b)({name:"emulator",initialState:_,reducers:{updateCode:function(e,t){e.code=t.payload},updateRegisters:function(e,t){e.registers=t.payload},updateMemory:function(e,t){e.memory=t.payload}}}),K=function(e){return e.emulator.code},ee=function(e){return e.emulator.memory},te=function(e){return e.emulator.registers},ne=q.actions,ie=ne.updateCode,re=ne.updateRegisters,ae=(ne.updateMemory,q.reducer),se=n(21),oe=n(22),ue=Object(h.a)((function(e){return{buttonsContainer:{background:e.palette.background.default,color:e.palette.text.primary,padding:"1.2rem"},fontAwesomeIcon:{width:"3rem",height:"2rem",outline:"none",display:"inline-block",textAlign:"center",background:"none"}}}));function le(){var e=ue(),t=Object(o.b)(),n=Object(o.c)(K);return r.a.createElement("div",{className:e.buttonsContainer},r.a.createElement("button",{type:"button",className:e.fontAwesomeIcon},r.a.createElement(se.a,{icon:oe.a})),r.a.createElement("button",{type:"button",className:e.fontAwesomeIcon},r.a.createElement(se.a,{icon:oe.d})),r.a.createElement("button",{type:"button",className:e.fontAwesomeIcon,onClick:function(){Y.loadCode(n),Y.cpu.step(),t(re(Y.getRegisters()))}},r.a.createElement(se.a,{icon:oe.b})),r.a.createElement("button",{type:"button",className:e.fontAwesomeIcon},r.a.createElement(se.a,{icon:oe.c})))}function ce(){var e=Object(o.b)();return r.a.createElement("div",null,r.a.createElement(le,null),r.a.createElement(p.a,{mode:"assembly_x86",fontSize:"1rem",theme:"dracula",onChange:function(t){e(ie(t))},value:"; Welcome to 8086.js!\n;\n; This is still under development and supports few instructions such as MOV, ADD, AND, etc.\n; Currently, it does not support pre-processor directives or interrupts.\n; Contribute to 8086.js at https://github.com/roerohan/8086.js :D\n\n",showPrintMargin:!1,height:"100vh",width:"50vw",name:"editor",editorProps:{$blockScrolling:!0}}))}var he=n(94),me=Object(h.a)((function(){return{display:{width:"inherit",height:"45vh",background:"#21222C",borderRadius:"0.5rem",padding:"0.5rem",border:"1px solid #44475A"},heading:{borderBottom:"1px solid #44475A",paddingBottom:"0.5rem"}}}));function pe(){var e=me();return r.a.createElement("div",{className:e.display},r.a.createElement("div",{className:e.heading},"Display"))}var ve=n(54),fe=Object(h.a)((function(e){return{register:{backgroundColor:e.palette.background.default,color:e.palette.text.primary,width:"4rem",fontSize:"1.2rem",padding:"0.3rem",textAlign:"center",border:"1px solid ".concat(e.palette.text.secondary)},label:{width:"3rem",display:"inline-block",color:e.palette.text.secondary},regContainer:{height:"5rem"}}}));function be(e){var t=fe(),n=e.name,a=Object(o.c)(te),s=Object(o.b)(),u=Object(i.useState)(a[n]),l=Object(ve.a)(u,2),c=l[0],h=l[1],m=a[n];Object(i.useEffect)((function(){h(a[n])}),[m,n,a]);return r.a.createElement("div",{className:t.regContainer},r.a.createElement("span",{className:t.label},n),r.a.createElement("input",{id:n,value:c,onChange:function(e){var t=e.target;console.log(t.value),Y.cpu.registers.regs[n].set(t.value),h(t.value),s(re(a))},className:t.register}))}var de=Object(h.a)((function(e){return{regAndMem:{textAlign:"left",marginTop:"2rem",display:"flex"},regRow:{width:"12rem"},paper:{color:e.palette.text.primary,borderRadius:"0.5rem",padding:"0.5rem",border:"1px solid #44475A",width:"27vw",height:"43vh",background:"#21222C",overflowY:"scroll"},heading:{borderBottom:"1px solid #44475A",paddingBottom:"0.5rem",textAlign:"center",position:"sticky"},memoryRow:{width:"100%",marginTop:"0.1rem",paddingBottom:"0.5rem",borderBottom:"1px solid #44475A"},memHeading:{fontWeight:"bold",marginTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid #44475A"},address:{width:"10rem",display:"inline-block",marginLeft:"3rem",textAlign:"center"},value:{textAlign:"center",display:"inline-block",width:"15rem"}}}));function ge(){var e=de(),t=Object(o.c)(te),n=Object(o.c)(ee);return console.log(n),r.a.createElement("div",{className:e.regAndMem},r.a.createElement("div",{className:e.regRow},r.a.createElement(be,{name:"AX",value:t.AX}),r.a.createElement(be,{name:"BX",value:t.BX}),r.a.createElement(be,{name:"CX",value:t.CX}),r.a.createElement(be,{name:"DX",value:t.DX}),r.a.createElement(be,{name:"BP",value:t.BP}),r.a.createElement(be,{name:"SP",value:t.SP})),r.a.createElement("div",{className:e.regRow},r.a.createElement(be,{name:"SI",value:t.SI}),r.a.createElement(be,{name:"DI",value:t.DI}),r.a.createElement(be,{name:"DS",value:t.DS}),r.a.createElement(be,{name:"ES",value:t.ES}),r.a.createElement(be,{name:"SS",value:t.SS}),r.a.createElement(be,{name:"CS",value:t.CS})),r.a.createElement("div",null,r.a.createElement(he.a,{className:e.paper},r.a.createElement("div",{className:e.heading},"Memory"),r.a.createElement("div",null,r.a.createElement("div",{className:e.memHeading},r.a.createElement("span",{className:e.address},"Address"),r.a.createElement("span",{className:e.value},"Value")),n.map((function(t,n){return r.a.createElement("div",{className:e.memoryRow},r.a.createElement("span",{className:e.address},n),r.a.createElement("span",{className:e.value},t))}))))))}var Ee=Object(h.a)((function(e){return{paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.primary,height:"100vh"}}}));function Ne(){var e=Ee();return r.a.createElement(he.a,{className:e.paper},r.a.createElement(pe,null),r.a.createElement(ge,null))}var Oe=Object(h.a)((function(){return{root:{flexGrow:1,height:"100vh"}}}));function we(){var e=Oe();return r.a.createElement("div",{className:e.root},r.a.createElement(c.a,{container:!0,spacing:1},r.a.createElement(c.a,{item:!0,xs:6},r.a.createElement(Ne,null)),r.a.createElement(c.a,{item:!0,xs:6},r.a.createElement(ce,null))))}var ye=Object(u.a)({palette:{type:"dark",background:{default:"#282a36",paper:"#282a36"},text:{primary:"#f8f8f2",secondary:"#6272a4"}}});var Ae=function(){return r.a.createElement(l.a,{theme:ye},r.a.createElement(we,null))},Se=Object(v.a)({reducer:{emulator:ae}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:Se},r.a.createElement(Ae,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[55,1,2]]]);
//# sourceMappingURL=main.701efdfd.chunk.js.map